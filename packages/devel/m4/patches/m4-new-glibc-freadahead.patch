diff -up m4-1.4.17/lib/freadahead.c\~ m4-1.4.17/lib/freadahead.c 
--- m4-1.4.17/lib/freadahead.c~	2019-08-18 20:29:58.935128110 +0200
+++ m4-1.4.17/lib/freadahead.c	2019-08-18 20:28:18.539299847 +0200
@@ -25,7 +25,7 @@
 size_t
 freadahead (FILE *fp)
 {
-#if defined _IO_ftrylockfile || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
+#if defined _IO_EOF_SEEN || __GNU_LIBRARY__ == 1 /* GNU libc, BeOS, Haiku, Linux libc5 */
   if (fp->_IO_write_ptr > fp->_IO_write_base)
     return 0;
   return (fp->_IO_read_end - fp->_IO_read_ptr)
